# Imgdiff TODO и журнал изменений (Change Log)

Дата: 2025-10-18

## Сделано (Completed)

- Overlay: единые цвета между экраном и файлом (match/add/delete)
  - Статус: выполнено (done)
  - Примечание: при сохранении временный SliderReveal получает текущие цвета явно.

- Save Overlay: композиция поверх базового изображения на белом фоне
  - Статус: выполнено (done)
  - Примечание: убрана полупрозрачная серая подложка в результате.

- Overlay (viewer): отрисовка базового изображения под полупрозрачным слоем
  - Статус: выполнено (done)
  - Примечание: наложение больше не скрывает картинку.

- Overlay (viewer): поддержка разных размеров без рескейла (паддинг)
  - Статус: выполнено (done)
  - Примечание: меньшая картинка дополняется до размера большей; маски считаются по паддингу.

- Batch compare: один финальный диалог (удалён дублирующий цикл запуска)
  - Статус: выполнено (done)
  - Примечание: задачи запускаются один раз; итоговое окно показывается один раз.

- Auto PNG compression (авто‑сжатие по площади отличий)
  - Статус: выполнено (done)
  - Примечание: добавлен тумблер в UI; в ROI и fallback запись учитывает долю diff.

- Auto‑align для «почти равных» (ECC, сдвиг)
  - Статус: выполнено (done)
  - Примечание: при pre‑check в пределах порога выравниваем B к A; затем пересчёт diff.

- Адаптивный ROI scale (coarse‑to‑fine)
  - Статус: выполнено (done)
  - Примечание: scale подбирается по мегапикселям: ≥20MP→0.15, ≥5MP→0.25, иначе 0.33.

- ResultCache: запись результата по завершении воркера
  - Статус: выполнено (done)
  - Примечание: в кэш пишутся code/duration/out_path по ключу, чтобы повторные запуски пропускались.

## В процессе / Запланировано (In Progress / Planned)

- Перевод подписей UI на русский
  - Статус: в работе
  - Примечание: заменить англ. подписи форм на русские, без изменения логики.

- Prefetch чтения файлов + тонкая настройка потоков OpenCV
  - Статус: запланировано
  - Примечание: асинхронно читать N следующих пар; cv2.setNumThreads(k) при необходимости.

## Заметки (Notes)

- Обновлять файл после каждого изменения (краткая запись + статус). Это простая история при обрыве контекста.

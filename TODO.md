# Imgdiff TODO и журнал изменений (Change Log)

Дата: 2025-10-19

## Сделано (Completed)

- Overlay: единые цвета между экраном и файлом (match/add/delete)
  - Статус: выполнено (done)
  - Примечание: при сохранении временный SliderReveal получает текущие цвета явно.

- Save Overlay: композиция поверх базового изображения на белом фоне
  - Статус: выполнено (done)
  - Примечание: убрана полупрозрачная серая подложка в результате.

- Overlay (viewer): отрисовка базового изображения под полупрозрачным слоем
  - Статус: выполнено (done)
  - Примечание: наложение больше не скрывает картинку.

- Overlay (viewer): поддержка разных размеров без рескейла (паддинг)
  - Статус: выполнено (done)
  - Примечание: меньшая картинка дополняется до размера большей; маски считаются по паддингу.

- Batch compare: один финальный диалог (удалён дублирующий цикл запуска)
  - Статус: выполнено (done)
  - Примечание: задачи запускаются один раз; итоговое окно показывается один раз.

- Auto PNG compression (авто‑сжатие по площади отличий)
  - Статус: выполнено (done)
  - Примечание: добавлен тумблер в UI; в ROI и fallback запись учитывает долю diff.

- Auto‑align для «почти равных» (ECC, сдвиг)
  - Статус: выполнено (done)
  - Примечание: при pre‑check в пределах порога выравниваем B к A; затем пересчёт diff.

- Адаптивный ROI scale (coarse‑to‑fine)
  - Статус: выполнено (done)
  - Примечание: scale подбирается по мегапикселям: ≥20MP→0.15, ≥5MP→0.25, иначе 0.33.

- ResultCache: запись результата по завершении воркера
  - Статус: выполнено (done)
  - Примечание: в кэш пишутся code/duration/out_path по ключу, чтобы повторные запуски пропускались.

- GitHub Actions: исправлена ошибка в release.yml
  - Статус: выполнено (done)
  - Дата: 2025-10-19
  - Примечание: заменён Python heredoc с tomllib на grep/sed для извлечения версии.

## В процессе / Запланировано (In Progress / Planned)

### Приоритет 1 (Документация и интернационализация)

- Добавить английскую версию README (README_EN.md)
  - Статус: запланировано
  - Примечание: перевести основной README на английский для расширения аудитории.

- Перевод UI на 2 языка (русский/английский)
  - Статус: запланировано
  - Примечание: реализовать i18n/l10n с переключателем языка в настройках. Использовать Qt Linguist или словари.

- Создать CONTRIBUTING.md
  - Статус: запланировано
  - Примечание: правила для контрибьюторов (стиль кода, как создавать PR, процесс review).

- Добавить примеры использования Python API в README
  - Статус: запланировано
  - Примечание: показать как использовать imgdiff как библиотеку (import imgdiff, основные функции).

- Создать FAQ секцию в документации
  - Статус: запланировано
  - Примечание: частые вопросы - как выбрать fuzz, что такое gamma, почему медленно работает и т.п.

### Приоритет 2 (Качество кода)

- Добавить type hints во все модули
  - Статус: запланировано
  - Примечание: полное покрытие type hints, включить mypy strict mode.

- Настроить pre-commit хуки (black/ruff)
  - Статус: запланировано
  - Примечание: автоматическое форматирование и линтинг перед коммитом.

### Приоритет 3 (Функциональность - позже)

- Поддержка WebP формата
  - Статус: запланировано (позже)
  - Примечание: добавить чтение/запись WebP изображений через OpenCV или Pillow.

- Экспорт отчётов в HTML/PDF
  - Статус: запланировано (позже)
  - Примечание: генерация отчёта с таблицей результатов, thumbnails, статистикой.

- Умная очистка кэша
  - Статус: запланировано (позже)
  - Примечание: автоудаление старых записей по возрасту/размеру, UI для управления кэшем.

### Приоритет 4 (Возможно в будущем)

- GPU ускорение (CUDA/OpenCL)
  - Статус: возможно (если не сильно менять архитектуру)
  - Примечание: использовать cv2.UMat или cupy для операций на GPU, бенчмарки GPU vs CPU.

### Ранее запланированные задачи

- Prefetch чтения файлов + тонкая настройка потоков OpenCV
  - Статус: запланировано
  - Примечание: асинхронно читать N следующих пар; cv2.setNumThreads(k) при необходимости.

## Заметки (Notes)

- Обновлять файл после каждого изменения (краткая запись + статус). Это простая история при обрыве контекста.
